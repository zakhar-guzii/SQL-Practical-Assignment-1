# E-commerce Database Project

This is the first homework assignment from the SQL database course. I decided to create an e-commerce database.

---

## Database Schema

### Customers
- `customer_id` – primary key, auto-increment.
- `first_name`, `last_name`, `email`, `phone`, `city`.
- `creation_time` – account creation date.
- `loyalty_points` – numeric value representing customer loyalty.

### Orders
- `order_id` – primary key, auto-increment.
- `customer_id` – foreign key to `customers`.
- `order_date`, `status` (Pending, Shipped, Delivered, Canceled).
- `payment_method` (Credit Card, Debit Card, Cash, Mobile Wallets, PayPal, Bank Transfer).
- `shipping_address`, `total_amount`.

### Suppliers
- `supplier_id` – primary key, auto-increment.
- `name`, `contact_name`, `email`, `phone`, `country`.
- `rating` – numeric score (0–5).

### Products
- `product_id` – primary key, auto-increment.
- `name`, `description`, `price`, `category`, `stock_quantity`.
- `supplier_id` – foreign key to `suppliers`.
- `created_at` – product creation date.

### Order Items
- `order_item_id` – primary key, auto-increment.
- `order_id` – foreign key to `orders`.
- `product_id` – foreign key to `products`.
- `quantity`, `unit_price`, `discount`.

---

## Query Logic

The main query identifies **top 30% customers** based on total spending and aggregates their orders and products. 

- **Step 1:** Calculate total spend and order count per customer.
- **Step 2:** Rank customers by total spending.
- **Step 3:** Join customers with orders, order items, and products.
- **Step 4:** Filter orders:
  - Orders after 2024-01-01 exceeding the average order value.
  - Delivered orders with expensive products (price above average).
- **Step 5:** Aggregate total spent on products per customer.
- **Step 6:** Filter customers with total product spending above 5000.
- **Step 7:** Sort by total spend and limit to the top 20.

This query provides a list of high-value customers for targeted marketing or loyalty programs.

---

## Data Generation

A Python script (`fata_faker.py`) populates the database using `Faker` and `mysql-connector-python`.

1. **Customers:** 5,000 random entries.
2. **Orders:** 50,000 random orders linked to customers.
3. **Suppliers:** 100 random suppliers.
4. **Products:** 2,000 products linked to suppliers.
5. **Order Items:** 50,000–200,000 order items linking products to orders, including random discounts.

This creates a realistic dataset for testing queries and analytics.

---

## Usage

1. Run `create_tables.sql` to create the database schema.
2. Run `fata_faker.py` to populate the database with test data.
3. Execute `queries.sql` to find top customers based on spending.

---

## Notes

- This markdown file was generated by chatGPT to simplify life for my teacher :)